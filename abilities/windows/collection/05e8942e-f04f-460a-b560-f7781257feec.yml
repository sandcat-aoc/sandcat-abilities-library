- id: 05e8942e-f04f-460a-b560-f7781257feec
  name: Copy and Compress AppData Folder
  description: Copies the AppData folder, compresses it, and cleans up temporary files.
  tactic: collection
  technique:
    attack_id: T1560.001
    name: 'Archive Collected Data: Archive via Utility'
  platforms:
    windows:
      psh:
        command: $AppData="$env:USERPROFILE\AppData"; $Copy="$env:USERPROFILE\Desktop\AppDataCopy";
          $Zip="$env:USERPROFILE\Desktop\AppDataBackup.zip"; if (Test-Path $Copy)
          { Remove-Item $Copy -Recurse -Force }; New-Item -ItemType Directory -Path
          $Copy | Out-Null; Get-ChildItem $AppData -Recurse -Force | ForEach-Object
          {; $rel = $_.FullName.Substring($AppData.Length + 1); $dest = Join-Path
          $Copy $rel; if ($_.PSIsContainer) { New-Item -ItemType Directory -Path $dest
          -Force | Out-Null }; else { Copy-Item $_.FullName -Destination $dest -Force
          -ErrorAction SilentlyContinue }; }; Add-Type -AssemblyName System.IO.Compression.FileSystem;
          [System.IO.Compression.ZipFile]::CreateFromDirectory($Copy, $Zip, [System.IO.Compression.CompressionLevel]::Optimal,
          $false)
        elevation_required: true
  plugin: atomic
  singleton: false
  repeatable: true
  delete_payload: false
  privilege: ''
  buckets:
  - atomic-red-team
  - t1560.001
  - collection
  author: Atomic Red Team
  additional_info:
    input_arguments:
      destination_folder:
        type: Path
        default: $env:USERPROFILE\Desktop\AppDataCopy
        description: Temporary copy location
      zip_file_path:
        type: Path
        default: $env:USERPROFILE\Desktop\AppDataBackup.zip
        description: ZIP archive path
    dependencies:
    - description: Requires admin and .NET compression libraries
      prereq_command: "if (-not ([Security.Principal.WindowsPrincipal] `\n    [Security.Principal.WindowsIdentity]::GetCurrent()).IsInRole(`\n\
        \    [Security.Principal.WindowsBuiltInRole]::Administrator)) { exit 1 }\n\
        if (-not (Test-Path \"$env:USERPROFILE\\AppData\")) { exit 1 }\n"
      get_prereq_command: 'Run PowerShell as Administrator and ensure .NET compression
        assemblies are available.

        '
    technique_created: '2020-02-20T21:01:25.428Z'
    atomic_guid: 05e8942e-f04f-460a-b560-f7781257feec
    import_timestamp: '2025-09-03T02:56:13.978208Z'
