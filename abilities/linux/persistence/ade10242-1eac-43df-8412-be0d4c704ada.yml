- id: ade10242-1eac-43df-8412-be0d4c704ada
  name: Trap SIGINT (freebsd)
  description: 'Launch bash shell with command arg to create TRAP on SIGINT (CTRL+C),
    then send SIGINT signal.

    The trap executes script that writes to /tmp/art-fish.txt'
  tactic: persistence
  technique:
    attack_id: T1546.005
    name: 'Event Triggered Execution: Trap'
  platforms:
    linux:
      sh:
        command: 'if [ ! -x "$(command -v bash)" ]; then : ; else (which pkg && pkg
          install -y bash); fi; bash -c ''trap "nohup sh $PathToAtomicsFolder/T1546.005/src/echo-art-fish.sh"
          SIGINT && kill -SIGINT $$'''
        cleanup: rm -f /tmp/art-fish.txt
  plugin: atomic
  singleton: false
  repeatable: true
  delete_payload: false
  privilege: ''
  buckets:
  - persistence
  - t1546.005
  - atomic-red-team
  author: Atomic Red Team
  additional_info:
    dependencies:
    - description: 'Check if bash is installed.

        '
      prereq_command: 'if [ ! -x "$(command -v bash)" ]; then exit 1; else exit 0;
        fi;

        '
      get_prereq_command: '(which pkg && pkg install -y bash)

        '
    technique_created: '2020-01-24T14:17:43.906Z'
    atomic_guid: ade10242-1eac-43df-8412-be0d4c704ada
    import_timestamp: '2025-07-27T03:47:18.415487Z'
