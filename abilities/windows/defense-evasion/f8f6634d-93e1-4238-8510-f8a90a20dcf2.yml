- id: f8f6634d-93e1-4238-8510-f8a90a20dcf2
  name: Windows - Modify file last modified timestamp with PowerShell
  description: 'Modifies the file last modified timestamp of a specified file. This
    technique was seen in use by the Stitch RAT.

    To verify execution, use File Explorer to view the Properties of the file and
    observe that the Modified time is the year 1970.'
  tactic: defense-evasion
  technique:
    attack_id: T1070.006
    name: 'Indicator Removal on Host: Timestomp'
  platforms:
    windows:
      psh:
        command: 'if (Test-Path "PathToAtomicsFolder\..\ExternalPayloads\T1551.006_timestomp.txt")
          {exit 0} else {exit 1}; then : ; else New-Item -Path "PathToAtomicsFolder\..\ExternalPayloads\T1551.006_timestomp.txt"
          -Force | Out-Null; Set-Content "PathToAtomicsFolder\..\ExternalPayloads\T1551.006_timestomp.txt"
          -Value "T1551.006 Timestomp" -Force | Out-Null; fi; Get-ChildItem "PathToAtomicsFolder\..\ExternalPayloads\T1551.006_timestomp.txt"
          | % { $_.LastWriteTime = "01/01/1970 00:00:00" }'
  plugin: atomic
  singleton: false
  repeatable: true
  delete_payload: false
  privilege: ''
  buckets:
  - defense-evasion
  - atomic-red-team
  - t1070.006
  author: Atomic Red Team
  additional_info:
    input_arguments:
      target_date_time:
        description: Date/time to replace original timestamps with
        type: string
        default: 01/01/1970 00:00:00
      file_path:
        description: Path of file to change modified timestamp
        type: path
        default: PathToAtomicsFolder\..\ExternalPayloads\T1551.006_timestomp.txt
    dependencies:
    - description: 'A file must exist at the path (#{file_path}) to change the modified
        time on

        '
      prereq_command: 'if (Test-Path "#{file_path}") {exit 0} else {exit 1}

        '
      get_prereq_command: 'New-Item -Path "#{file_path}" -Force | Out-Null

        Set-Content "#{file_path}" -Value "T1551.006 Timestomp" -Force | Out-Null

        '
    technique_created: '2020-01-31T12:42:44.103Z'
    atomic_guid: f8f6634d-93e1-4238-8510-f8a90a20dcf2
    import_timestamp: '2025-07-09T03:22:47.165028Z'
