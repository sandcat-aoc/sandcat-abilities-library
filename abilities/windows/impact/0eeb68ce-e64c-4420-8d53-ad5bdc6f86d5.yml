- id: 0eeb68ce-e64c-4420-8d53-ad5bdc6f86d5
  name: Windows - Display a simulated ransom note via Notepad (non-destructive)
  description: 'Creates a temporary ransom-note text file and opens it in Notepad
    to

    simulate ransomware "note display" behavior without making destructive

    changes. SAFE and non-destructive.'
  tactic: impact
  technique:
    attack_id: T1491.001
    name: 'Defacement: Internal Defacement'
  platforms:
    windows:
      psh:
        command: $notePath = Join-Path $env:TEMP "ART-T1491-ransom-note.txt"; $pidPath  =
          Join-Path $env:TEMP "ART-T1491-notepad.pid"; $Title = "!!! READ_ME_NOW !!!";
          $Body  = "Your files are SAFE. This is a TEST note for detection validation;
          by bak3n3k0. No data has been encrypted. This simulation exercises; detections
          for:; - notepad.exe launched with a ransom-themed text file; - creation
          of a ransom-themed text file in %TEMP%; NON-DESTRUCTIVE Atomic Red Team
          test.; "; $header  = $Title + "`r`n" + ('=' * $Title.Length) + "`r`n`r`n";
          $content = $header + $Body; [System.IO.File]::WriteAllText($notePath, $content,
          [System.Text.Encoding]::UTF8); $p = Start-Process notepad.exe -ArgumentList
          "`"$notePath`"" -PassThru; $p.Id | Out-File -FilePath $pidPath -Encoding
          ascii -Force
        cleanup: 'try {; # 1. Kill all Notepad processes; Get-Process notepad -ErrorAction
          SilentlyContinue |; ForEach-Object {; Stop-Process -Id $_.Id -Force -ErrorAction
          SilentlyContinue; }; # 2. Wait briefly for Windows to release file handles;
          Start-Sleep -Seconds 1; # 3. Force delete ransom note + PID file; $notePath
          = Join-Path $env:TEMP "ART-T1491-ransom-note.txt"; $pidPath  = Join-Path
          $env:TEMP "ART-T1491-notepad.pid"; if (Test-Path $notePath) {; Remove-Item
          $notePath -Force -ErrorAction Stop; }; if (Test-Path $pidPath) {; Remove-Item
          $pidPath -Force -ErrorAction Stop; }; }; catch {; Write-Warning "Cleanup
          failed with error: $_"; }'
        elevation_required: false
  plugin: atomic
  singleton: false
  repeatable: true
  delete_payload: false
  privilege: ''
  buckets:
  - t1491.001
  - atomic-red-team
  - impact
  author: Atomic Red Team
  additional_info:
    input_arguments:
      note_filename:
        description: File name for the simulated ransom note
        type: string
        default: ART-T1491-ransom-note.txt
      pid_filename:
        description: File name for storing Notepad PID
        type: string
        default: ART-T1491-notepad.pid
      note_title:
        description: Title at the top of the ransom note
        type: string
        default: '!!! READ_ME_NOW !!!'
      note_body:
        description: The body of the ransom note (plain text)
        type: string
        default: "Your files are SAFE. This is a TEST note for detection validation\n\
          by bak3n3k0. No data has been encrypted. This simulation exercises\ndetections\
          \ for:\n  - notepad.exe launched with a ransom-themed text file\n  - creation\
          \ of a ransom-themed text file in %TEMP%\nNON-DESTRUCTIVE Atomic Red Team\
          \ test.\n"
    dependencies:
    - description: Notepad must be present on the system
      dependency_executor_name: command_prompt
      prereq_command: where notepad
      get_prereq_command: ''
    technique_created: '2020-02-20T14:31:34.778Z'
    atomic_guid: 0eeb68ce-e64c-4420-8d53-ad5bdc6f86d5
    import_timestamp: '2025-09-24T03:00:57.723946Z'
