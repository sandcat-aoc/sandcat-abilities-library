- id: 8b34a448-40d9-4fc3-a8c8-4bb286faf7dc
  name: Indirect Command Execution - forfiles.exe
  description: 'forfiles.exe may invoke the execution of programs and commands from
    a Command-Line Interface.

    [Reference](https://github.com/LOLBAS-Project/LOLBAS/blob/master/yml/OSBinaries/Forfiles.yml)

    "This is basically saying for each occurrence of notepad.exe in c:\windows\system32
    run calc.exe"

    Upon execution calc.exe will be opened.'
  tactic: defense-evasion
  technique:
    attack_id: T1202
    name: Indirect Command Execution
  platforms:
    windows:
      sh:
        command: forfiles /p c:\windows\system32 /m notepad.exe /c calc.exe
  plugin: atomic
  singleton: false
  repeatable: true
  delete_payload: false
  privilege: ''
  buckets:
  - atomic-red-team
  - defense-evasion
  - t1202
  author: Atomic Red Team
  additional_info:
    input_arguments:
      process:
        description: Process to execute
        type: string
        default: calc.exe
    technique_created: '2018-04-18T17:59:24.739Z'
    atomic_guid: 8b34a448-40d9-4fc3-a8c8-4bb286faf7dc
    import_timestamp: '2025-08-17T03:26:13.226626Z'
