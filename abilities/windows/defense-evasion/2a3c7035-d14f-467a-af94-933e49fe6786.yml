- id: 2a3c7035-d14f-467a-af94-933e49fe6786
  name: Process Injection with Go using CreateThread WinAPI (Natively)
  description: 'This program executes shellcode in the current process using the following
    steps

    1. Allocate memory for the shellcode with VirtualAlloc setting the page permissions
    to Read/Write

    2. Use the RtlCopyMemory macro to copy the shellcode to the allocated memory space

    3. Change the memory page permissions to Execute/Read with VirtualProtect

    4. Call CreateThread on shellcode address

    5. Call WaitForSingleObject so the program does not end before the shellcode is
    executed


    This program loads the DLLs and gets a handle to the used procedures itself instead
    of using the windows package directly.


    - PoC Credit: (https://github.com/Ne0nd0g/go-shellcode#createthreadnative)'
  tactic: defense-evasion
  technique:
    attack_id: T1055
    name: Process Injection
  platforms:
    windows:
      psh:
        command: $PathToAtomicsFolder\T1055\bin\x64\CreateThreadNative.exe -debug
        cleanup: Stop-Process -Name CalculatorApp -ErrorAction SilentlyContinue
        elevation_required: false
  plugin: atomic
  singleton: false
  repeatable: true
  delete_payload: false
  privilege: ''
  buckets:
  - t1055
  - atomic-red-team
  - defense-evasion
  author: Atomic Red Team
  additional_info:
    technique_created: '2017-05-31T21:30:47.843Z'
    atomic_guid: 2a3c7035-d14f-467a-af94-933e49fe6786
    import_timestamp: '2025-08-10T03:44:39.598040Z'
