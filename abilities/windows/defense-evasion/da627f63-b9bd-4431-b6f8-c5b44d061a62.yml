- id: da627f63-b9bd-4431-b6f8-c5b44d061a62
  name: Windows - Modify file last access timestamp with PowerShell
  description: 'Modifies the last access timestamp of a specified file. This technique
    was seen in use by the Stitch RAT.

    To verify execution, use File Explorer to view the Properties of the file and
    observe that the Accessed time is the year 1970.'
  tactic: defense-evasion
  technique:
    attack_id: T1070.006
    name: 'Indicator Removal on Host: Timestomp'
  platforms:
    windows:
      psh:
        command: 'if (Test-Path "PathToAtomicsFolder\..\ExternalPayloads\T1551.006_timestomp.txt")
          {exit 0} else {exit 1}; then : ; else New-Item -Path "PathToAtomicsFolder\..\ExternalPayloads\T1551.006_timestomp.txt"
          -Force | Out-Null; Set-Content "PathToAtomicsFolder\..\ExternalPayloads\T1551.006_timestomp.txt"
          -Value "T1551.006 Timestomp" -Force | Out-Null; fi; Get-ChildItem "PathToAtomicsFolder\..\ExternalPayloads\T1551.006_timestomp.txt"
          | % { $_.LastAccessTime = "01/01/1970 00:00:00" }'
  plugin: atomic
  singleton: false
  repeatable: true
  delete_payload: false
  privilege: ''
  buckets:
  - t1070.006
  - atomic-red-team
  - defense-evasion
  author: Atomic Red Team
  additional_info:
    input_arguments:
      target_date_time:
        description: Date/time to replace original timestamps with
        type: string
        default: 01/01/1970 00:00:00
      file_path:
        description: Path of file to change last access timestamp
        type: path
        default: PathToAtomicsFolder\..\ExternalPayloads\T1551.006_timestomp.txt
    dependencies:
    - description: 'A file must exist at the path ("#{file_path}") to change the last
        access time on

        '
      prereq_command: 'if (Test-Path "#{file_path}") {exit 0} else {exit 1}

        '
      get_prereq_command: 'New-Item -Path "#{file_path}" -Force | Out-Null

        Set-Content "#{file_path}" -Value "T1551.006 Timestomp" -Force | Out-Null

        '
    technique_created: '2020-01-31T12:42:44.103Z'
    atomic_guid: da627f63-b9bd-4431-b6f8-c5b44d061a62
    import_timestamp: '2025-06-24T11:15:00.318204Z'
