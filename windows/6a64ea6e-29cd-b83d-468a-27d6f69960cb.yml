- description: 'This test injects a MessageBox shellcode generated by msfvenom in
    Notepad.exe using Thread Execution Hijacking. When successful, a message box will
    appear with the "Atomic Red Team" caption after one or two seconds. '
  id: 6a64ea6e-29cd-b83d-468a-27d6f69960cb
  name: Thread Execution Hijacking
  platforms:
    windows:
      psh:
        cleanup: ''
        command: $notepad = Start-Process notepad -passthru; Start-Process "$PathToAtomicsFolder\T1055.003\bin\InjectContext.exe";
          Start-Sleep -Seconds 5; Stop-Process $notepad.id
        parsers:
          plugins.atomic.app.parsers.atomic_powershell:
          - source: validate_me
        payloads: []
  tactic: multiple
  technique:
    attack_id: T1055.003
    name: Thread Execution Hijacking
